Uma versão melhor do meu código anterior
(ainda em desenvolvimento)
